import{r as Q,o as p,c as f,b as e,n as B,_ as C,p as H,f as J,g as y,d as r,w as v,C as O,l as I,E as W,F as q,e as L,v as X,t as h,M as Y,L as Z}from"./index-4YiyT363.js";import{a as P,Q as ee}from"./QTable-DpG9Lfxj.js";import{B as oe,b as te,s as le}from"./store-DQyzeTJc.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QLinearProgress-q4xJ436M.js";const x=c=>(H("data-v-cef8a51b"),c=c(),J(),c),ne=["open"],ae={class:"dialog-b"},de=x(()=>e("h3",null,"책 등록!",-1)),re=x(()=>e("label",{for:"title"},"제목",-1)),ie=x(()=>e("label",{for:"author"},"작가",-1)),ce=x(()=>e("label",{for:"price"},"가격",-1)),ue=x(()=>e("label",{for:"published-date"},"발행일",-1)),pe={class:"grid"},fe={__name:"BookAddForm",emits:["addedBook"],setup(c,{expose:u,emit:t}){const _=t,o=Q({formOpen:!1,title:"",author:"",price:0,date:""});function k(){console.log("Call child openBookForm"),o.formOpen=!0}function b(){o.title="",o.author="",o.price=0,o.date="",o.formOpen=!1}function V(){return!(o.title==""||o.author==""||o.price==0||o.date=="")}function A(){if(V()){const w=oe.createBook(o.title,o.author,o.price,o.date);te.save(w),console.log("book 추가하기 성공"),_("addedBook"),b()}else alert("책 정보를 입력하세요~~~")}return u({openBookForm:k}),(w,s)=>(p(),f("dialog",{open:o.formOpen},[e("article",ae,[de,re,B(e("input",{id:"title",type:"text",placeholder:"제목을 입력하세요","onUpdate:modelValue":s[0]||(s[0]=n=>o.title=n)},null,512),[[C,o.title]]),ie,B(e("input",{id:"author",type:"text",placeholder:"작가명 입력","onUpdate:modelValue":s[1]||(s[1]=n=>o.author=n)},null,512),[[C,o.author]]),ce,B(e("input",{id:"price",type:"number",placeholder:"제목을 입력하세요","onUpdate:modelValue":s[2]||(s[2]=n=>o.price=n)},null,512),[[C,o.price]]),ue,B(e("input",{id:"published-date",type:"date","onUpdate:modelValue":s[3]||(s[3]=n=>o.date=n)},null,512),[[C,o.date]]),e("div",pe,[e("a",{href:"#cancel",role:"button",class:"secondary",onClick:s[4]||(s[4]=n=>b())},"취소"),e("a",{href:"#confirm",role:"button",onClick:s[5]||(s[5]=n=>A())},"등록")])])],8,ne))}},_e=se(fe,[["__scopeId","data-v-cef8a51b"]]),me=["open"],he=e("h1",{"aria-busy":"true"},null,-1),ke=[he],be={__name:"Progress",setup(c,{expose:u}){const t=y(!1);function _(){console.log("Call child openBookForm"),t.value=!0}function o(){t.value=!1}return u({show:_,hide:o}),(k,b)=>(p(),f("dialog",{open:t.value},ke,8,me))}},ge=e("div",{class:"text-h5"},"책",-1),ve={class:"q-gutter-md"},Be={class:"q-my-md"},ye={role:"grid"},xe=["checked"],we=e("th",null,"#",-1),$e=e("th",null,"제목",-1),Ce=e("th",null,"작가",-1),Ve=e("th",null,"가격",-1),Ae=e("th",null,"발행일",-1),Fe=["value"],Re={href:"#"},Se={href:"#"},Ue={class:"grid page-num"},Oe=e("a",null,"prev",-1),Ie=e("a",null,"next",-1),qe={__name:"BookList",setup(c){const u=le.bookRepository,t=Q({selectedAll:!1,books:null,selectedBook:[]});t.books=s();const _=y(),o=y([]);let k;const b=[{name:"id",required:!0,label:"no.",align:"left",field:a=>a.id,format:a=>`${a}`,sortable:!0},{name:"title",align:"center",label:"제목",field:"title",sortable:!0},{name:"author",align:"center",label:"저자",field:"author",sortable:!0},{name:"price",align:"center",label:"가격",field:"price"},{name:"publishDate",align:"center",label:"발행일",field:"publishDate"}],V=s();function A({rows:a,added:d,evt:l}){if(a.length!==1||l===void 0)return;const i=k,[g]=a,{ctrlKey:G,shiftKey:T}=l;T!==!0&&(k=g),Y(()=>{if(T===!0){const R=_.value.filteredSortedRows;let m=R.indexOf(i),$=R.indexOf(g);m<0&&(m=0),m>$&&([m,$]=[$,m]);const E=R.slice(m,$+1),S=o.value.map(Z);o.value=d===!0?S.concat(E.filter(U=>S.includes(U)===!1)):S.filter(U=>E.includes(U)===!1)}else G!==!0&&d===!0&&(o.value=[g])})}function w(){console.log("[debug] updateChecked"),t.selectedAll?(t.selectedAll=!1,t.selectedBook.splice(0,t.selectedBook.length)):(t.selectedAll=!0,t.books.forEach(a=>{t.selectedBook.push(a.id)}))}function s(){return u.findAll()}function n(){t.books=s(),M()}function N(){if(console.log("[debug] Modify book"),t.selectedBook.length>1){alert("여러 항목을 동시에 수정할 수 없습니다. 하나만 선택하세요.");return}M()}function K(){console.log("[debug] remove books "+t.selectedBook),t.selectedBook.forEach(a=>u.delete(a)),t.selectedAll=!1,n()}const D=y("");function j(){console.log("Call parent openBookForm()"),D.value.openBookForm()}const F=y("");function M(){F.value.show(),setTimeout(()=>{F.value.hide()},1e3)}function z(){console.log("[debug] selected book :"+t.selectedBook)}return(a,d)=>(p(),f(q,null,[ge,e("div",ve,[r(I,{color:"primary",onClick:j,class:"q-mx-sm"},{default:v(()=>[O("추가")]),_:1}),r(I,{color:"primary",onClick:K,class:"q-mx-sm"},{default:v(()=>[O("삭제")]),_:1}),r(I,{color:"primary",onClick:N,class:"q-mx-sm"},{default:v(()=>[O("수정")]),_:1})]),e("div",Be,[r(ee,{ref_key:"tableRef",ref:_,title:"책 리스트",rows:W(V),columns:b,"row-key":"id",selection:"multiple",selected:o.value,"onUpdate:selected":d[0]||(d[0]=l=>o.value=l),onSelection:A},{"header-selection":v(l=>[r(P,{modelValue:l.selected,"onUpdate:modelValue":i=>l.selected=i},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":v(l=>[r(P,{"model-value":l.selected,"onUpdate:modelValue":(i,g)=>{Object.getOwnPropertyDescriptor(l,"selected").set(i,g)}},null,8,["model-value","onUpdate:modelValue"])]),_:1},8,["rows","selected"])]),e("table",ye,[e("thead",null,[e("th",null,[e("input",{type:"checkbox",checked:t.selectedAll,onChange:d[1]||(d[1]=l=>w())},null,40,xe)]),we,$e,Ce,Ve,Ae]),e("tbody",null,[(p(!0),f(q,null,L(t.books,l=>(p(),f("tr",{key:l.id},[e("td",null,[B(e("input",{type:"checkbox","onUpdate:modelValue":d[2]||(d[2]=i=>t.selectedBook=i),value:l.id,onChange:d[3]||(d[3]=i=>z())},null,40,Fe),[[X,t.selectedBook]])]),e("td",null,[e("a",Re,h(l.id),1)]),e("td",null,[e("a",Se,h(l.title),1)]),e("td",null,h(l.author),1),e("td",null,h(l.price),1),e("td",null,h(l.publishDate),1)]))),128))])]),e("div",Ue,[Oe,(p(),f(q,null,L(10,l=>e("a",{key:l},h(l),1)),64)),Ie]),r(_e,{ref_key:"bookAddForm",ref:D,onAddedBook:n},null,512),r(be,{ref_key:"progress",ref:F},null,512)],64))}},Pe={__name:"BooksPage",setup(c){return(u,t)=>(p(),f("div",null,[r(qe)]))}};export{Pe as default};
